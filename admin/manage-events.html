<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Events - Admin Panel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        body { padding-top: 0; }
        .admin-wrapper { display: flex; }
        .admin-content { flex-grow: 1; padding: 20px; }
    </style>
</head>
<body>

    <div class="admin-wrapper">
        <nav class="admin-sidebar d-flex flex-column p-3 text-white">
            <h4 class="text-center mb-4">Admin Panel</h4>
            <ul class="nav nav-pills flex-column mb-auto">
                <li class="nav-item">
                    <a href="index.html" class="nav-link text-white">
                        <i class="fas fa-tachometer-alt me-2"></i> Dashboard
                    </a>
                </li>
                <li>
                    <a href="manage-events.html" class="nav-link active">
                        <i class="fas fa-calendar-plus me-2"></i> Manage Events
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link text-white">
                        <i class="fas fa-ticket-alt me-2"></i> View Bookings
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link text-white">
                        <i class="fas fa-users me-2"></i> Manage Users
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link text-white">
                        <i class="fas fa-chart-line me-2"></i> Reports
                    </a>
                </li>
            </ul>
            <hr>
            <div class="dropdown">
                <a href="#" class="d-flex align-items-center text-white text-decoration-none dropdown-toggle" id="dropdownUser1" data-bs-toggle="dropdown" aria-expanded="false">
            
                    <strong>Admin User</strong>
                </a>
                <ul class="dropdown-menu dropdown-menu-dark text-small shadow" aria-labelledby="dropdownUser1">
                    <li><a class="dropdown-item" href="#">Profile</a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li><a class="dropdown-item" href="../index.html">Sign out</a></li>
                </ul>
            </div>
        </nav>
        <div class="admin-content">
            <h1 class="mb-4">Manage Events</h1>

            <button class="btn btn-primary mb-4" data-bs-toggle="modal" data-bs-target="#addEditEventModal">
                <i class="fas fa-plus-circle me-2"></i> Add New Event
            </button>

            <div class="card shadow-sm">
                <div class="card-header">All Events</div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Image</th>
                                    <th>Name</th>
                                    <th>Date</th>
                                    <th>Venue</th>
                                    <th>Price</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="admin-event-list">
                                <tr>
                                    <td>1</td>
                                    <td><img src="../img/event1.jpg" alt="Event" width="50" height="50" style="object-fit: cover; border-radius: 5px;"></td>
                                    <td>Tech Innovators Summit 2025</td>
                                    <td>2025-07-15</td>
                                    <td>Eko Convention Centre, BUEA</td>
                                    <td>XFA 25,000</td>
                                    <td>
                                        <button class="btn btn-sm btn-info me-2 edit-event-btn" data-id="1"><i class="fas fa-edit"></i> Edit</button>
                                        <button class="btn btn-sm btn-danger delete-event-btn" data-id="1"><i class="fas fa-trash"></i> Delete</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td><img src="../img/event2.jpg" alt="Event" width="50" height="50" style="object-fit: cover; border-radius: 5px;"></td>
                                    <td>Afro Music Fest</td>
                                    <td>2025-08-20</td>
                                    <td>Olembe Stadium, Abuja</td>
                                    <td>XFA 15,000</td>
                                    <td>
                                        <button class="btn btn-sm btn-info me-2 edit-event-btn" data-id="2"><i class="fas fa-edit"></i> Edit</button>
                                        <button class="btn btn-sm btn-danger delete-event-btn" data-id="2"><i class="fas fa-trash"></i> Delete</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        </div>

    <div class="modal fade" id="addEditEventModal" tabindex="-1" aria-labelledby="addEditEventModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="addEditEventModalLabel">Add/Edit Event</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="event-form">
                        <input type="hidden" id="eventId">
                        <div class="mb-3">
                            <label for="eventName" class="form-label">Event Name</label>
                            <input type="text" class="form-control" id="eventName" required>
                        </div>
                        <div class="mb-3">
                            <label for="eventDate" class="form-label">Date</label>
                            <input type="date" class="form-control" id="eventDate" required>
                        </div>
                        <div class="mb-3">
                            <label for="eventTime" class="form-label">Time</label>
                            <input type="time" class="form-control" id="eventTime" required>
                        </div>
                        <div class="mb-3">
                            <label for="eventVenue" class="form-label">Venue</label>
                            <input type="text" class="form-control" id="eventVenue" required>
                        </div>
                        <div class="mb-3">
                            <label for="eventLocation" class="form-label">Location (e.g., Yaounde, Buea)</label>
                            <input type="text" class="form-control" id="eventLocation" required>
                        </div>
                        <div class="mb-3">
                            <label for="eventOrganizer" class="form-label">Organizer</label>
                            <input type="text" class="form-control" id="eventOrganizer" required>
                        </div>
                        <div class="mb-3">
                            <label for="eventCategory" class="form-label">Category</label>
                            <input type="text" class="form-control" id="eventCategory" required>
                        </div>
                        <div class="mb-3">
                            <label for="eventPrice" class="form-label">Base Ticket Price</label>
                            <input type="number" class="form-control" id="eventPrice" min="0" required>
                        </div>
                        <div class="mb-3">
                            <label for="eventImage" class="form-label">Image URL</label>
                            <input type="url" class="form-control" id="eventImage" placeholder="e.g., img/event_new.jpg">
                        </div>
                        <div class="mb-3">
                            <label for="eventDescription" class="form-label">Description</label>
                            <textarea class="form-control" id="eventDescription" rows="3"></textarea>
                        </div>

                        <h6 class="mt-4">Ticket Types (Example, would be dynamic in real PHP)</h6>
                        <div id="ticket-types-admin-container">
                            <div class="row g-2 mb-2 border p-2 rounded">
                                <div class="col-md-4">
                                    <label class="form-label small">Type Name</label>
                                    <input type="text" class="form-control form-control-sm" placeholder="Standard">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label small">Price</label>
                                    <input type="number" class="form-control form-control-sm" placeholder="25000">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label small">Available</label>
                                    <input type="number" class="form-control form-control-sm" placeholder="100">
                                </div>
                                <div class="col-md-2 d-flex align-items-end">
                                    <button type="button" class="btn btn-danger btn-sm"><i class="fas fa-times"></i></button>
                                </div>
                            </div>
                            <button type="button" class="btn btn-sm btn-outline-secondary mt-2"><i class="fas fa-plus"></i> Add Ticket Type</button>
                        </div>

                        <div class="d-grid mt-4">
                            <button type="submit" class="btn btn-primary" id="save-event-btn">Save Event</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const adminEventList = document.getElementById('admin-event-list');
            const addEditEventModal = new bootstrap.Modal(document.getElementById('addEditEventModal'));
            const eventForm = document.getElementById('event-form');
            const saveEventBtn = document.getElementById('save-event-btn');

            // Dummy data for admin panel - in real app, fetch from PHP
            let adminEvents = [
                {
                    id: 1,
                    name: 'Tech Innovators Summit 2025',
                    date: '2025-07-15',
                    time: '09:00 AM',
                    venue: 'Eko Convention Centre, BUEA',
                    location: 'Buea',
                    organizer: 'FutureTech Corp',
                    image: '',
                    price: 25000,
                    category: 'tech',
                    description: 'A groundbreaking summit bringing together the brightest minds in technology.',
                    ticket_types: [
                        { type: 'Standard', price: 25000, available: 100 },
                        { type: 'VIP', price: 50000, available: 20 }
                    ]
                },
                {
                    id: 2,
                    name: 'Afro Music Fest',
                    date: '2025-08-20',
                    time: '06:00 PM',
                    venue: 'Olembe Stadium, Yaounde',
                    location: 'Yaounde',
                    organizer: 'SoundWave Entertainment',
                    image: '/img/Event.jpg',
                    price: 15000,
                    category: 'music',
                    description: 'Experience the best of African music with top artists from across the continent.',
                    ticket_types: [
                        { type: 'Regular', price: 15000, available: 500 },
                        { type: 'VIP', price: 30000, available: 100 }
                    ]
                }
            ];

            const renderAdminEvents = () => {
                adminEventList.innerHTML = '';
                adminEvents.forEach(event => {
                    const row = `
                        <tr>
                            <td>${event.id}</td>
                            <td><img src="${event.image}" alt="${event.name}" width="50" height="50" style="object-fit: cover; border-radius: 5px;"></td>
                            <td>${event.name}</td>
                            <td>${event.date}</td>
                            <td>${event.venue}</td>
                            <td>â‚¦${event.price.toLocaleString()}</td>
                            <td>
                                <button class="btn btn-sm btn-info me-2 edit-event-btn" data-id="${event.id}"><i class="fas fa-edit"></i> Edit</button>
                                <button class="btn btn-sm btn-danger delete-event-btn" data-id="${event.id}"><i class="fas fa-trash"></i> Delete</button>
                            </td>
                        </tr>
                    `;
                    adminEventList.innerHTML += row;
                });

                document.querySelectorAll('.edit-event-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const eventId = parseInt(e.target.dataset.id || e.target.closest('button').dataset.id);
                        const eventToEdit = adminEvents.find(event => event.id === eventId);
                        if (eventToEdit) {
                            document.getElementById('addEditEventModalLabel').textContent = 'Edit Event';
                            document.getElementById('eventId').value = eventToEdit.id;
                            document.getElementById('eventName').value = eventToEdit.name;
                            document.getElementById('eventDate').value = eventToEdit.date;
                            document.getElementById('eventTime').value = eventToEdit.time;
                            document.getElementById('eventVenue').value = eventToEdit.venue;
                            document.getElementById('eventLocation').value = eventToEdit.location;
                            document.getElementById('eventOrganizer').value = eventToEdit.organizer;
                            document.getElementById('eventCategory').value = eventToEdit.category;
                            document.getElementById('eventPrice').value = eventToEdit.price;
                            document.getElementById('eventImage').value = eventToEdit.image;
                            document.getElementById('eventDescription').value = eventToEdit.description;

                            // Populate ticket types - this would be more complex with dynamic fields
                            // For simplicity, just showing how you'd fill basic fields.
                            // You'd need logic to add/remove ticket type fields
                            document.getElementById('ticket-types-admin-container').innerHTML = '<p class="text-muted small">Dynamic ticket types would go here.</p>';

                            addEditEventModal.show();
                        }
                    });
                });

                document.querySelectorAll('.delete-event-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const eventId = parseInt(e.target.dataset.id || e.target.closest('button').dataset.id);
                        if (confirm(`Are you sure you want to delete event ID ${eventId}?`)) {
                            // In real app, send DELETE request to PHP
                            adminEvents = adminEvents.filter(event => event.id !== eventId);
                            renderAdminEvents(); // Re-render table
                            alert(`Event ID ${eventId} deleted (simulated).`);
                        }
                    });
                });
            };

            eventForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const eventId = document.getElementById('eventId').value;
                const newEvent = {
                    id: eventId ? parseInt(eventId) : adminEvents.length > 0 ? Math.max(...adminEvents.map(e => e.id)) + 1 : 1,
                    name: document.getElementById('eventName').value,
                    date: document.getElementById('eventDate').value,
                    time: document.getElementById('eventTime').value,
                    venue: document.getElementById('eventVenue').value,
                    location: document.getElementById('eventLocation').value,
                    organizer: document.getElementById('eventOrganizer').value,
                    category: document.getElementById('eventCategory').value,
                    price: parseFloat(document.getElementById('eventPrice').value),
                    image: document.getElementById('eventImage').value || '../img/placeholder.jpg', // Default image
                    description: document.getElementById('eventDescription').value,
                    ticket_types: [] // This would be populated from dynamic fields in a real app
                };

                if (eventId) {
                    // Update existing event
                    const index = adminEvents.findIndex(event => event.id === newEvent.id);
                    if (index > -1) {
                        adminEvents[index] = newEvent;
                    }
                    alert('Event updated (simulated)!');
                } else {
                    // Add new event
                    adminEvents.push(newEvent);
                    alert('Event added (simulated)!');
                }
                renderAdminEvents();
                addEditEventModal.hide();
                eventForm.reset();
            });

            // Reset form when modal is hidden
            document.getElementById('addEditEventModal').addEventListener('hidden.bs.modal', function () {
                eventForm.reset();
                document.getElementById('eventId').value = ''; // Clear hidden ID field
                document.getElementById('addEditEventModalLabel').textContent = 'Add/Edit Event';
                // Reset dynamic ticket types fields if implemented
            });


            renderAdminEvents(); // Initial load of events for admin
        });
    </script>
  <footer class="bg-dark text-white text-center py-4 mt-5">
    <div class="container">
        <p>&copy; 2025 Eventify. All rights reserved.</p>
        <p>
            <a href="#" class="text-white mx-2"><i class="fab fa-facebook-f"></i></a>
            <a href="#" class="text-white mx-2"><i class="fab fa-twitter"></i></a>
            <a href="#" class="text-white mx-2"><i class="fab fa-instagram"></i></a>
        </p>
    </div>
</footer>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>
<script src="js/script.js"></script>
</body>
</html>